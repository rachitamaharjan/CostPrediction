knitr::opts_chunk$set(echo = TRUE)
quartile(insurance$charges)
quantile(insurance$charges)
library(dplyr)
library(ggplot2)
insurance<-read.csv("insurance.csv")
insurance
str(insurance)
is.na(insurance) #how many empty
table(is.na(insurance)) #total numbers
head(insurance)  #first 6 values
head(insurance, 10)
tail(insurance)  #last 6 values
tail(insurance, 10)
colSums(is.na(insurance)) #adds true and false values i.e 1 and 0 i.e total missing values
#imputation
insurance$age[is.na(insurance$age)] <- median(insurance$age,na.rm = TRUE)
insurance$charges[is.na(insurance$charges)] <- median(insurance$charges,na.rm = TRUE)
Mode <- function(x){
ux <- unique(x)
ux[which.max(tabulate(match(x,ux)))]
}
insurance$region[is.na(insurance$region)] <- Mode(insurance$region)
quantile(insurance$charges)
quartile(insurance$charges)
quantile(insurance$charges)
range(insurance$age)
var(insurance$age)
sd(insurance$age)
cor(insurance[c("age","bmi","children","charges")])
cor(insurance[c("age","bmi","children","charges","sex")])
cor(insurance[c("age","bmi","children","charges")])
install.packages("corrplot")
corrplot(cor(insurance[c("age","bmi","children","charges")]))
corrplot(cor(insurance[c("age","bmi","children","charges")]),method="color")
install.packages("corrplot")
library(corrplot)
corrplot(cor(insurance[c("age","bmi","children","charges")]),method="color")
pairs(select(insurance,age,bmi,children,charges))
ggplot(data = insurance)+geom_point(aes(x=age, y=charges))
ggplot(data = insurance)+geom_point(aes(x=bmi, y=charges))
ggplot(data = insurance)+geom_point(aes(x=age, y=bmi))
ggplot(data = insurance)+geom_density(aes(x=age))
ggplot(data = insurance)+geom_density(aes(x= charge))
ggplot(data = insurance)+geom_density(aes(x= charges))
ggplot(data = insurance)+geom_density(aes(x= sex))
gen_df <-as.data.frame(table(insurance$sex))
names(gen_df) <- c("gender","count")
gen_df <-as.data.frame(table(insurance$sex))
names(gen_df) <- c("gender","count")
g <- ggplot(data = gen_df) + geom_col(aes(x= gender, y=count, fill=gender))
g +labs(title = "gender distribution") + theme_minimal()
table(insurance$children)
chi_df <-as.data.frame(table(insurance$sex))
names(chi_df) <- c("gender","count")
g <- ggplot(data = chi_df) + geom_col(aes(x= children, y=count, fill=children))
g +labs(title = "child distribution") + theme_minimal()
chi_df <-as.data.frame(table(insurance$children))
names(chi_df) <- c("gender","count")
g <- ggplot(data = chi_df) + geom_col(aes(x= children, y=count, fill=children))
g +labs(title = "child distribution") + theme_minimal()
chi_df <-as.data.frame(table(insurance$children))
names(chi_df) <- c("children","count")
g <- ggplot(data = chi_df) + geom_col(aes(x= children, y=count, fill=children))
g +labs(title = "child distribution") + theme_minimal()
ggplot(data = insurance) + geom_density(aes(x= bmi))
ggplot(data = insurance)+geom_point(aes(x=bmi, y=charges, color =smoker),alpha=0.8 +theme_gray())
ggplot(data = insurance)+geom_point(aes(x=bmi, y=charges, color =smoker),alpha=0.8) +theme_gray()
group_df <- group_by(insurance, smoker)
avg_charge <- summarise(group_df, mean(charges))
avg_charge
knitr::opts_chunk$set(echo = TRUE)
saveRDS(insurance,"insurance.rds")
saveRDS(insurance,"insurance.rds")
